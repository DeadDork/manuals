<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>Module::Build::Cookbook - perldoc.perl.org</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta http-equiv="Content-Language" content="en-gb">
  <link rel="search" type="application/opensearchdescription+xml" title="Search perldoc.perl.org" href="/static/search.xml"/>
  <link href="../../static/css-20100830.css" rel="stylesheet" rev="stylesheet" type="text/css" media="screen">
  <link href="../../static/exploreperl.css" rel="stylesheet" rev="stylesheet" type="text/css">
</head>

<body onLoad="perldoc.startup();" onPageShow="if (event.persisted) perldoc.startup();">
    <div id="page">
      
      <div id="header">
	<div id="homepage_link">
	  <a href="../../index.html"></a>
	</div>
	<div id="strapline">
	  Perl Programming Documentation
	</div>
	<div id="download_link" class="download">
	  <a href="http://www.perl.org/get.html">Download Perl</a>
	</div>
	<div id="explore_link" class="download">
	  <a id="explore_anchor" href="#">Explore</a>
	</div>
      </div>
      
      <div id="body">
        <div id="left_column">
          <div class="side_group">
            
	    <div class="side_panel doc_panel">
              <p>Manual</p>
              <ul>
                <li><a href="../../index-overview.html">Overview</a>
                <li><a href="../../index-tutorials.html">Tutorials</a>
                <li><a href="../../index-faq.html">FAQs</a>
                <li><a href="../../index-history.html">History / Changes</a>
                <li><a href="../../index-licence.html">License</a>
              </ul>
            </div>
            <div class="side_panel doc_panel">
              <p>Reference</p>
              <ul>
                <li><a href="../../index-language.html">Language</a>
                <li><a href="../../index-functions.html">Functions</a>
                <li><a href="../../perlop.html">Operators</a>
                <li><a href="../../perlvar.html">Special Variables</a>
                <li><a href="../../index-pragmas.html">Pragmas</a>
                <li><a href="../../index-utilities.html">Utilities</a>
                <li><a href="../../index-internals.html">Internals</a>
                <li><a href="../../index-platforms.html">Platform Specific</a>
              </ul>
            </div>
            <div class="side_panel doc_panel">
              <p>Modules</p>
              <ul>
		<li>
		
                
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		
                  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		
                  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		
                  
		
                  
		    
		  
		
                  
		
                  
		
		
                    <a href="../../index-modules-A.html">A</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-B.html">B</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-C.html">C</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-D.html">D</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-E.html">E</a>
                    
                      
                        <li>
                      
                    
                
                    <a href="../../index-modules-F.html">F</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-G.html">G</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-H.html">H</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-I.html">I</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-L.html">L</a>
                    
                      
                        <li>
                      
                    
                
                    <a href="../../index-modules-M.html">M</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-N.html">N</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-O.html">O</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-P.html">P</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-S.html">S</a>
                    
                      
                        <li>
                      
                    
                
                    <a href="../../index-modules-T.html">T</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-U.html">U</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../../index-modules-X.html">X</a>
                    
                
              </ul>
            </div>
            
	      <div class="side_panel doc_panel">
		<p>Tools</p>
		<ul>
		  <li><a href="../../preferences.html">Preferences</a>
		</ul>
	      </div>
            
          </div>
        </div>
        <div id="centre_column">
          <div id="content_header">
            <div id="title_bar">
              <div id="page_name">
                <h1>Module::Build::Cookbook</h1>
              </div>
              <div id="perl_version">
                Perl 5 version 16.0 documentation
              </div>
              <div class="page_links" id="page_links_top">
                <a href="#" onClick="toolbar.goToTop();return false;">Go to top</a>
		
              </div>
	      <div class="page_links" id="page_links_bottom">
		
                  <a href="#" id="page_index_toggle">Show page index</a> &bull;
		
                <a href="#" id="recent_pages_toggle">Show recent pages</a>		
	      </div>
	      <div id="search_form">
		<form action="../../search.html" method="GET" id="search">
		  <input type="text" name="q" id="search_box" alt="Search">
		</form>
	      </div>
            </div>
            <div id="breadcrumbs">
                
    <a href="../../index.html">Home</a> &gt;
    
      
        <a href="../../index-modules-M.html">Core modules (M)</a> &gt;
      
    
    Module::Build::Cookbook
  

            </div>
          </div>
          <div id="content_body">
	    <!--[if lt IE 7]>
 <div class="noscript">
   <p>
     <strong>It looks like you're using Internet Explorer 6. This is a very old
     browser which does not offer full support for modern websites.</strong>
   </p>
   <p>
     Unfortunately this means that this website will not work on
     your computer.
   </p>
   <p>
     Don't miss out though! To view the site (and get a better experience from
     many other websites), simply upgrade to
     <a href="http://www.microsoft.com/windows/Internet-explorer/default.aspx">Internet
Explorer 8</a>
     or download an alternative browser such as
     <a href="http://www.mozilla.com/en-US/firefox/firefox.html">Firefox</a>,
     <a href="http://www.apple.com/safari/download/">Safari</a>, or
     <a href="http://www.google.co.uk/chrome">Google Chrome</a>.
   </p>
   <p>
     All of these browsers are free. If you're using a PC at work, you may
     need to contact your IT administrator.
   </p>
 </div>
<![endif]-->
	    <noscript>
	      <div class="noscript">
	      <p>
                <strong>Please note: Many features of this site require JavaScript. You appear to have JavaScript disabled,
	        or are running a non-JavaScript capable web browser.</strong>
	      </p>
	      <p>
		To get the best experience, please enable JavaScript or download a modern web browser such as <a href="http://www.microsoft.com/windows/Internet-explorer/default.aspx">Internet Explorer 8</a>, <a href="http://www.mozilla.com/en-US/firefox/firefox.html">Firefox</a>, <a href="http://www.apple.com/safari/download/">Safari</a>, or <a href="http://www.google.co.uk/chrome">Google Chrome</a>.
              </p>
	      </div>
	    </noscript>

	    <div id="recent_pages" class="hud_container">
	      <div id="recent_pages_header" class="hud_header">
		<div id="recent_pages_close" class="hud_close"><a href="#" onClick="recentPages.hide();return false;"></a></div>
		<div id="recent_pages_title" class="hud_title"><span class="hud_span_top">Recently read</span></div>
		<div id="recent_pages_topright" class="hud_topright"></div>
	      </div>
	      <div id="recent_pages_content" class="hud_content">
	      </div>
	      <div id="recent_pages_footer" class="hud_footer">
		<div id="recent_pages_bottomleft" class="hud_bottomleft"></div>
		<div id="recent_pages_bottom" class="hud_bottom"><span class="hud_span_bottom"></span></div>
		<div id="recent_pages_resize" class="hud_resize"></div>
	      </div>
	    </div>
  
	    <div id="from_search"></div>
            <h1>Module::Build::Cookbook</h1>


  <!--    -->
<ul><li><a href="#NAME">NAME</a><li><a href="#DESCRIPTION">DESCRIPTION</a><li><a href="#BASIC-RECIPES">BASIC RECIPES</a><ul><li><a href="#Installing-modules-that-use-Module%3a%3aBuild">Installing modules that use Module::Build</a><li><a href="#Modifying-Config.pm-values">Modifying Config.pm values</a><li><a href="#Installing-modules-using-the-programmatic-interface">Installing modules using the programmatic interface</a><li><a href="#Installing-to-a-temporary-directory">Installing to a temporary directory</a><li><a href="#Installing-to-a-non-standard-directory">Installing to a non-standard directory</a><li><a href="#Installing-in-the-same-location-as-ExtUtils%3a%3aMakeMaker">Installing in the same location as ExtUtils::MakeMaker</a><li><a href="#Running-a-single-test-file">Running a single test file</a></ul><li><a href="#ADVANCED-RECIPES">ADVANCED RECIPES</a><ul><li><a href="#Making-a-CPAN.pm-compatible-distribution">Making a CPAN.pm-compatible distribution</a><li><a href="#Changing-the-order-of-the-build-process">Changing the order of the build process</a><li><a href="#Adding-new-file-types-to-the-build-process">Adding new file types to the build process</a><li><a href="#Adding-new-elements-to-the-install-process">Adding new elements to the install process</a></ul><li><a href="#EXAMPLES-ON-CPAN">EXAMPLES ON CPAN</a><ul><li><a href="#SVN-Notify-Mirror">SVN-Notify-Mirror</a><li><a href="#Modifying-an-action">Modifying an action</a><li><a href="#Adding-an-action">Adding an action</a><li><a href="#Bundling-Module%3a%3aBuild">Bundling Module::Build</a></ul><li><a href="#AUTHOR">AUTHOR</a><li><a href="#COPYRIGHT">COPYRIGHT</a><li><a href="#SEE-ALSO">SEE ALSO</a></ul><a name="NAME"></a><h1>NAME</h1>
<p>Module::Build::Cookbook - Examples of Module::Build Usage</p>
<a name="DESCRIPTION"></a><h1>DESCRIPTION</h1>
<p><code class="inline"><span class="w">Module::Build</span></code>
 isn't conceptually very complicated, but examples are
always helpful.  The following recipes should help developers and/or
installers put together the pieces from the other parts of the
documentation.</p>
<a name="BASIC-RECIPES"></a><h1>BASIC RECIPES</h1>
<a name="Installing-modules-that-use-Module%3a%3aBuild"></a><h2>Installing modules that use Module::Build</h2>
<p>In most cases, you can just issue the following commands:</p>
<pre class="verbatim"><ol><li>  perl Build.PL</li><li>  ./Build</li><li>  ./Build test</li><li>  ./Build install</li></ol></pre><p>There's nothing complicated here - first you're running a script
called <i>Build.PL</i>, then you're running a (newly-generated) script
called <i>Build</i> and passing it various arguments.</p>
<p>The exact commands may vary a bit depending on how you invoke perl
scripts on your system.  For instance, if you have multiple versions
of perl installed, you can install to one particular perl's library
directories like so:</p>
<pre class="verbatim"><ol><li>  /usr/bin/perl5.8.1 Build.PL</li><li>  ./Build</li><li>  ./Build test</li><li>  ./Build install</li></ol></pre><p>If you're on Windows where the current directory is always searched
first for scripts, you'll probably do something like this:</p>
<pre class="verbatim"><ol><li>  <span class="w">perl</span> <span class="w">Build</span>.<span class="w">PL</span></li><li>  <span class="w">Build</span></li><li>  <span class="w">Build</span> <span class="w">test</span></li><li>  <span class="w">Build</span> <span class="w">install</span></li></ol></pre><p>On the old Mac OS (version 9 or lower) using MacPerl, you can
double-click on the <i>Build.PL</i> script to create the <i>Build</i> script,
then double-click on the <i>Build</i> script to run its <code class="inline"><span class="w">build</span></code>
, <code class="inline"><span class="w">test</span></code>
,
and <code class="inline"><span class="w">install</span></code>
 actions.</p>
<p>The <i>Build</i> script knows what perl was used to run <i>Build.PL</i>, so
you don't need to re-invoke the <i>Build</i> script with the complete perl
path each time.  If you invoke it with the <i>wrong</i> perl path, you'll
get a warning or a fatal error.</p>
<a name="Modifying-Config.pm-values"></a><h2>Modifying Config.pm values</h2>
<p><code class="inline"><span class="w">Module::Build</span></code>
 relies heavily on various values from perl's
<code class="inline"><span class="w">Config</span>.<span class="w">pm</span></code>
 to do its work.  For example, default installation paths
are given by <code class="inline"><span class="w">installsitelib</span></code>
 and <code class="inline"><span class="w">installvendorman3dir</span></code>
 and
friends, C linker &amp; compiler settings are given by <code class="inline"><span class="w">ld</span></code>
,
<code class="inline"><span class="w">lddlflags</span></code>
, <code class="inline"><span class="w">cc</span></code>
, <code class="inline"><span class="w">ccflags</span></code>
, and so on.  <i>If you're pretty sure
you know what you're doing</i>, you can tell <code class="inline"><span class="w">Module::Build</span></code>
 to pretend
there are different values in <i>Config.pm</i> than what's really there,
by passing arguments for the <code class="inline">--<span class="w">config</span></code>
 parameter on the command
line:</p>
<pre class="verbatim"><ol><li>  perl Build.PL --config cc=gcc --config ld=gcc</li></ol></pre><p>Inside the <code class="inline"><span class="w">Build</span>.<span class="w">PL</span></code>
 script the same thing can be accomplished by
passing values for the <code class="inline"><span class="w">config</span></code>
 parameter to <code class="inline"><span class="i">new</span><span class="s">(</span><span class="s">)</span></code>
:</p>
<pre class="verbatim"><ol><li> <a class="l_k" href="../../functions/my.html">my</a> <span class="i">$build</span> = <span class="w">Module::Build</span><span class="w">-&gt;new</span></li><li>   <span class="s">(</span></li><li>    ...</li><li>    <span class="w">config</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">cc</span> <span class="cm">=&gt;</span> <span class="q">'gcc'</span><span class="cm">,</span> <span class="w">ld</span> <span class="cm">=&gt;</span> <span class="q">'gcc'</span> <span class="s">}</span><span class="cm">,</span></li><li>    ...</li><li>   <span class="s">)</span><span class="sc">;</span></li></ol></pre><p>In custom build code, the same thing can be accomplished by calling
the <a href="../../Module/Build.html#config">config in Module::Build</a> method:</p>
<pre class="verbatim"><ol><li> <span class="i">$build</span><span class="i">-&gt;config</span><span class="s">(</span> <span class="w">cc</span> <span class="cm">=&gt;</span> <span class="q">'gcc'</span> <span class="s">)</span><span class="sc">;</span>     <span class="c"># Set</span></li><li> <span class="i">$build</span><span class="i">-&gt;config</span><span class="s">(</span> <span class="w">ld</span> <span class="cm">=&gt;</span> <span class="q">'gcc'</span> <span class="s">)</span><span class="sc">;</span>     <span class="c"># Set</span></li><li> ...</li><li> <a class="l_k" href="../../functions/my.html">my</a> <span class="i">$linker</span> = <span class="i">$build</span><span class="i">-&gt;config</span><span class="s">(</span><span class="q">'ld'</span><span class="s">)</span><span class="sc">;</span> <span class="c"># Get</span></li></ol></pre><a name="Installing-modules-using-the-programmatic-interface"></a><h2>Installing modules using the programmatic interface</h2>
<p>If you need to build, test, and/or install modules from within some
other perl code (as opposed to having the user type installation
commands at the shell), you can use the programmatic interface.
Create a Module::Build object (or an object of a custom Module::Build
subclass) and then invoke its <code class="inline"><span class="i">dispatch</span><span class="s">(</span><span class="s">)</span></code>
 method to run various
actions.</p>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../../functions/my.html">my</a> <span class="i">$build</span> = <span class="w">Module::Build</span><span class="w">-&gt;new</span></li><li>    <span class="s">(</span></li><li>     <span class="w">module_name</span> <span class="cm">=&gt;</span> <span class="q">'Foo::Bar'</span><span class="cm">,</span></li><li>     <span class="w">license</span>     <span class="cm">=&gt;</span> <span class="q">'perl'</span><span class="cm">,</span></li><li>     <span class="w">requires</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="q">'Some::Module'</span>   <span class="cm">=&gt;</span> <span class="q">'1.23'</span> <span class="s">}</span><span class="cm">,</span></li><li>    <span class="s">)</span><span class="sc">;</span></li><li>  <span class="i">$build</span><span class="i">-&gt;dispatch</span><span class="s">(</span><span class="q">'build'</span><span class="s">)</span><span class="sc">;</span></li><li>  <span class="i">$build</span><span class="i">-&gt;dispatch</span><span class="s">(</span><span class="q">'test'</span><span class="cm">,</span> <span class="w">verbose</span> <span class="cm">=&gt;</span> <span class="n">1</span><span class="s">)</span><span class="sc">;</span></li><li>  <span class="i">$build</span><span class="i">-&gt;dispatch</span><span class="s">(</span><span class="q">'install'</span><span class="s">)</span><span class="sc">;</span></li></ol></pre><p>The first argument to <code class="inline"><span class="i">dispatch</span><span class="s">(</span><span class="s">)</span></code>
 is the name of the action, and any
following arguments are named parameters.</p>
<p>This is the interface we use to test Module::Build itself in the
regression tests.</p>
<a name="Installing-to-a-temporary-directory"></a><h2>Installing to a temporary directory</h2>
<p>To create packages for package managers like RedHat's <code class="inline"><span class="w">rpm</span></code>
 or
Debian's <code class="inline"><span class="w">deb</span></code>
, you may need to install to a temporary directory
first and then create the package from that temporary installation.
To do this, specify the <code class="inline"><span class="w">destdir</span></code>
 parameter to the <code class="inline"><span class="w">install</span></code>
 action:</p>
<pre class="verbatim"><ol><li>  ./Build install --destdir /tmp/my-package-1.003</li></ol></pre><p>This essentially just prepends all the installation paths with the
<i>/tmp/my-package-1.003</i> directory.</p>
<a name="Installing-to-a-non-standard-directory"></a><h2>Installing to a non-standard directory</h2>
<p>To install to a non-standard directory (for example, if you don't have
permission to install in the system-wide directories), you can use the
<code class="inline"><span class="w">install_base</span></code>
 or <code class="inline"><span class="w">prefix</span></code>
 parameters:</p>
<pre class="verbatim"><ol><li>  ./Build install --install_base /foo/bar</li></ol></pre><p>See <a href="../../Module/Build.html#INSTALL-PATHS">INSTALL PATHS in Module::Build</a> for a much more complete
discussion of how installation paths are determined.</p>
<a name="Installing-in-the-same-location-as-ExtUtils%3a%3aMakeMaker"></a><h2>Installing in the same location as ExtUtils::MakeMaker</h2>
<p>With the introduction of <code class="inline">--<span class="w">prefix</span></code>
 in Module::Build 0.28 and
<code class="inline"><span class="w">INSTALL_BASE</span></code>
 in <code class="inline"><span class="w">ExtUtils::MakeMaker</span></code>
 6.31 its easy to get them both
to install to the same locations.</p>
<p>First, ensure you have at least version 0.28 of Module::Build
installed and 6.31 of <code class="inline"><span class="w">ExtUtils::MakeMaker</span></code>
.  Prior versions have
differing (and in some cases quite strange) installation behaviors.</p>
<p>The following installation flags are equivalent between
<code class="inline"><span class="w">ExtUtils::MakeMaker</span></code>
 and <code class="inline"><span class="w">Module::Build</span></code>
.</p>
<pre class="verbatim"><ol><li>    MakeMaker             Module::Build</li><li>    PREFIX=...            --prefix ...</li><li>    INSTALL_BASE=...      --install_base ...</li><li>    DESTDIR=...           --destdir ...</li><li>    LIB=...               --install_path lib=...</li><li>    INSTALLDIRS=...       --installdirs ...</li><li>    INSTALLDIRS=perl      --installdirs core</li><li>    UNINST=...            --uninst ...</li><li>    INC=...               --extra_compiler_flags ...</li><li>    POLLUTE=1             --extra_compiler_flags -DPERL_POLLUTE</li></ol></pre><p>For example, if you are currently installing <code class="inline"><span class="w">MakeMaker</span></code>
 modules with
this command:</p>
<pre class="verbatim"><ol><li>    <span class="w">perl</span> <span class="w">Makefile</span>.<span class="w">PL</span> <span class="w">PREFIX</span>=~</li><li>    <span class="w">make</span> <span class="w">test</span></li><li>    <span class="w">make</span> <span class="w">install</span> <span class="w">UNINST</span>=<span class="n">1</span></li></ol></pre><p>You can install into the same location with Module::Build using this:</p>
<pre class="verbatim"><ol><li>    perl Build.PL --prefix ~</li><li>    ./Build test</li><li>    ./Build install --uninst 1</li></ol></pre><a name="prefix-vs-install_base"></a><h3><code class="inline"><span class="w">prefix</span></code>
 vs <code class="inline"><span class="w">install_base</span></code>
</h3>
<p>The behavior of <code class="inline"><span class="w">prefix</span></code>
 is complicated and depends on
how your Perl is configured.  The resulting installation locations
will vary from machine to machine and even different installations of
Perl on the same machine.  Because of this, it's difficult to document
where <code class="inline"><span class="w">prefix</span></code>
 will place your modules.</p>
<p>In contrast, <code class="inline"><span class="w">install_base</span></code>
 has predictable, easy to explain
installation locations.  Now that <code class="inline"><span class="w">Module::Build</span></code>
 and <code class="inline"><span class="w">MakeMaker</span></code>
 both
have <code class="inline"><span class="w">install_base</span></code>
 there is little reason to use <code class="inline"><span class="w">prefix</span></code>
 other
than to preserve your existing installation locations.  If you are
starting a fresh Perl installation we encourage you to use
<code class="inline"><span class="w">install_base</span></code>
.  If you have an existing installation installed via
<code class="inline"><span class="w">prefix</span></code>
, consider moving it to an installation structure matching
<code class="inline"><span class="w">install_base</span></code>
 and using that instead.</p>
<a name="Running-a-single-test-file"></a><h2>Running a single test file</h2>
<p><code class="inline"><span class="w">Module::Build</span></code>
 supports running a single test, which enables you to
track down errors more quickly.  Use the following format:</p>
<pre class="verbatim"><ol><li>  ./Build test --test_files t/mytest.t</li></ol></pre><p>In addition, you may want to run the test in verbose mode to get more
informative output:</p>
<pre class="verbatim"><ol><li>  ./Build test --test_files t/mytest.t --verbose 1</li></ol></pre><p>I run this so frequently that I define the following shell alias:</p>
<pre class="verbatim"><ol><li>  <span class="w">alias</span> <span class="w">t</span> <span class="q">'./Build test --verbose 1 --test_files'</span></li></ol></pre><p>So then I can just execute <code class="inline"><span class="w">t</span> <span class="w">t</span>/<span class="w">mytest</span>.<span class="w">t</span></code>
 to run a single test.</p>
<a name="ADVANCED-RECIPES"></a><h1>ADVANCED RECIPES</h1>
<a name="Making-a-CPAN.pm-compatible-distribution"></a><h2>Making a CPAN.pm-compatible distribution</h2>
<p>New versions of CPAN.pm understand how to use a <i>Build.PL</i> script,
but old versions don't.  If authors want to help users who have old
versions, some form of <i>Makefile.PL</i> should be supplied.  The easiest
way to accomplish this is to use the <code class="inline"><span class="w">create_makefile_pl</span></code>
 parameter to
<code class="inline"><span class="w">Module::Build</span><span class="w">-&gt;new</span><span class="s">(</span><span class="s">)</span></code>
 in the <code class="inline"><span class="w">Build</span>.<span class="w">PL</span></code>
 script, which can
create various flavors of <i>Makefile.PL</i> during the <code class="inline"><span class="w">dist</span></code>
 action.</p>
<p>As a best practice, we recommend using the "traditional" style of
<i>Makefile.PL</i> unless your distribution has needs that can't be
accomplished that way.</p>
<p>The <code class="inline"><span class="w">Module::Build::Compat</span></code>
 module, which is part of
<code class="inline"><span class="w">Module::Build</span></code>
's distribution, is responsible for creating these
<i>Makefile.PL</i>s.  Please see <a href="../../Module/Build/Compat.html">Module::Build::Compat</a> for the details.</p>
<a name="Changing-the-order-of-the-build-process"></a><h2>Changing the order of the build process</h2>
<p>The <code class="inline"><span class="w">build_elements</span></code>
 property specifies the steps <code class="inline"><span class="w">Module::Build</span></code>

will take when building a distribution.  To change the build order,
change the order of the entries in that property:</p>
<pre class="verbatim"><ol><li>  <span class="c"># Process pod files first</span></li><li>  <a class="l_k" href="../../functions/my.html">my</a> <span class="i">@e</span> = <span class="i">@</span>{<span class="i">$build</span><span class="i">-&gt;build_elements</span>}<span class="sc">;</span></li><li>  <a class="l_k" href="../../functions/my.html">my</a> <span class="s">(</span><span class="i">$i</span><span class="s">)</span> = <a class="l_k" href="../../functions/grep.html">grep</a> <span class="s">{</span><span class="i">$e</span>[<span class="i">$_</span>] eq <span class="q">&#39;pod&#39;</span><span class="s">}</span> <span class="n">0</span>..<span class="i">$#e</span><span class="sc">;</span></li><li>  <a class="l_k" href="../../functions/unshift.html">unshift</a> <span class="i">@e</span><span class="cm">,</span> <a class="l_k" href="../../functions/splice.html">splice</a> <span class="i">@e</span><span class="cm">,</span> <span class="i">$i</span><span class="cm">,</span> <span class="n">1</span><span class="sc">;</span></li></ol></pre><p>Currently, <code class="inline"><span class="w">build_elements</span></code>
 has the following default value:</p>
<pre class="verbatim"><ol><li>  <span class="s">[</span><span class="q">qw( PL support pm xs pod script )</span><span class="s">]</span></li></ol></pre><p>Do take care when altering this property, since there may be
non-obvious (and non-documented!) ordering dependencies in the
<code class="inline"><span class="w">Module::Build</span></code>
 code.</p>
<a name="Adding-new-file-types-to-the-build-process"></a><h2>Adding new file types to the build process</h2>
<p>Sometimes you might have extra types of files that you want to install
alongside the standard types like <i>.pm</i> and <i>.pod</i> files.  For
instance, you might have a <i>Bar.dat</i> file containing some data
related to the <code class="inline"><span class="w">Foo::Bar</span></code>
 module and you'd like for it to end up as
<i>Foo/Bar.dat</i> somewhere in perl's <code class="inline"><span class="i">@INC</span></code>
 path so <code class="inline"><span class="w">Foo::Bar</span></code>
 can
access it easily at runtime.  The following code from a sample
<code class="inline"><span class="w">Build</span>.<span class="w">PL</span></code>
 file demonstrates how to accomplish this:</p>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../../functions/use.html">use</a> <span class="w">Module::Build</span><span class="sc">;</span></li><li>  <a class="l_k" href="../../functions/my.html">my</a> <span class="i">$build</span> = <span class="w">Module::Build</span><span class="w">-&gt;new</span></li><li>    <span class="s">(</span></li><li>     <span class="w">module_name</span> <span class="cm">=&gt;</span> <span class="q">'Foo::Bar'</span><span class="cm">,</span></li><li>     ...<span class="w">other</span> <span class="w">stuff</span> <span class="w">here</span>...</li><li>    <span class="s">)</span><span class="sc">;</span></li><li>  <span class="i">$build</span><span class="i">-&gt;add_build_element</span><span class="s">(</span><span class="q">'dat'</span><span class="s">)</span><span class="sc">;</span></li><li>  <span class="i">$build</span><span class="i">-&gt;create_build_script</span><span class="sc">;</span></li></ol></pre><p>This will find all <i>.dat</i> files in the <i>lib/</i> directory, copy them
to the <i>blib/lib/</i> directory during the <code class="inline"><span class="w">build</span></code>
 action, and install
them during the <code class="inline"><span class="w">install</span></code>
 action.</p>
<p>If your extra files aren't located in the <code class="inline"><span class="w">lib</span>/</code>
 directory in your
distribution, you can explicitly say where they are, just as you'd do
with <i>.pm</i> or <i>.pod</i> files:</p>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../../functions/use.html">use</a> <span class="w">Module::Build</span><span class="sc">;</span></li><li>  <a class="l_k" href="../../functions/my.html">my</a> <span class="i">$build</span> = <span class="w">new</span> <span class="w">Module::Build</span></li><li>    <span class="s">(</span></li><li>     <span class="w">module_name</span> <span class="cm">=&gt;</span> <span class="q">'Foo::Bar'</span><span class="cm">,</span></li><li>     <span class="w">dat_files</span> <span class="cm">=&gt;</span> <span class="s">{</span><span class="q">'some/dir/Bar.dat'</span> <span class="cm">=&gt;</span> <span class="q">'lib/Foo/Bar.dat'</span><span class="s">}</span><span class="cm">,</span></li><li>     ...<span class="w">other</span> <span class="w">stuff</span> <span class="w">here</span>...</li><li>    <span class="s">)</span><span class="sc">;</span></li><li>  <span class="i">$build</span><span class="i">-&gt;add_build_element</span><span class="s">(</span><span class="q">'dat'</span><span class="s">)</span><span class="sc">;</span></li><li>  <span class="i">$build</span><span class="i">-&gt;create_build_script</span><span class="sc">;</span></li></ol></pre><p>If your extra files actually need to be created on the user's machine,
or if they need some other kind of special processing, you'll probably
want to subclass <code class="inline"><span class="w">Module::Build</span></code>
 and create a special method to
process them, named <code class="inline">process_${kind}_files()</code>:</p>
<pre class="verbatim"><ol><li>  use Module::Build;</li><li>  my $class = Module::Build-&gt;subclass(code =&gt; &lt;&lt;'EOF');</li><li>    sub process_dat_files {</li><li>      my $self = shift;</li><li>      ... locate and process *.dat files,</li><li>      ... and create something in blib/lib/</li><li>    }</li><li>  EOF</li><li>  my $build = $class-&gt;new</li><li>    (</li><li>     module_name =&gt; 'Foo::Bar',</li><li>     ...other stuff here...</li><li>    );</li><li>  $build-&gt;add_build_element('dat');</li><li>  $build-&gt;create_build_script;</li></ol></pre><p>If your extra files don't go in <i>lib/</i> but in some other place, see
<a href="#Adding-new-elements-to-the-install-process">Adding new elements to the install process</a> for how to actually
get them installed.</p>
<p>Please note that these examples use some capabilities of Module::Build
that first appeared in version 0.26.  Before that it could
still be done, but the simple cases took a bit more work.</p>
<a name="Adding-new-elements-to-the-install-process"></a><h2>Adding new elements to the install process</h2>
<p>By default, Module::Build creates seven subdirectories of the <i>blib</i>
directory during the build process: <i>lib</i>, <i>arch</i>, <i>bin</i>,
<i>script</i>, <i>bindoc</i>, <i>libdoc</i>, and <i>html</i> (some of these may be
missing or empty if there's nothing to go in them).  Anything copied
to these directories during the build will eventually be installed
during the <code class="inline"><span class="w">install</span></code>
 action (see <a href="../../Module/Build.html#INSTALL-PATHS">INSTALL PATHS in Module::Build</a>.</p>
<p>If you need to create a new custom type of installable element, e.g. <code class="inline"><span class="w">conf</span></code>
,
then you need to tell Module::Build where things in <i>blib/conf/</i>
should be installed.  To do this, use the <code class="inline"><span class="w">install_path</span></code>
 parameter to
the <code class="inline"><span class="i">new</span><span class="s">(</span><span class="s">)</span></code>
 method:</p>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../../functions/my.html">my</a> <span class="i">$build</span> = <span class="w">Module::Build</span><span class="w">-&gt;new</span></li><li>    <span class="s">(</span></li><li>     ...<span class="w">other</span> <span class="w">stuff</span> <span class="w">here</span>...</li><li>     <span class="w">install_path</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">conf</span> <span class="cm">=&gt;</span> <span class="i">$installation_path</span> <span class="s">}</span></li><li>    <span class="s">)</span><span class="sc">;</span></li></ol></pre><p>Or you can call the <code class="inline"><span class="i">install_path</span><span class="s">(</span><span class="s">)</span></code>
 method later:</p>
<pre class="verbatim"><ol><li>  <span class="i">$build</span><span class="i">-&gt;install_path</span><span class="s">(</span><span class="w">conf</span> <span class="cm">=&gt;</span> <span class="i">$installation_path</span><span class="s">)</span><span class="sc">;</span></li></ol></pre><p>The user may also specify the path on the command line:</p>
<pre class="verbatim"><ol><li>  perl Build.PL --install_path conf=/foo/path/etc</li></ol></pre><p>The important part, though, is that <i>somehow</i> the install path needs
to be set, or else nothing in the <i>blib/conf/</i> directory will get
installed, and a runtime error during the <code class="inline"><span class="w">install</span></code>
 action will
result.</p>
<p>See also <a href="#Adding-new-file-types-to-the-build-process">Adding new file types to the build process</a> for how to
create the stuff in <i>blib/conf/</i> in the first place.</p>
<a name="EXAMPLES-ON-CPAN"></a><h1>EXAMPLES ON CPAN</h1>
<p>Several distributions on CPAN are making good use of various features
of Module::Build.  They can serve as real-world examples for others.</p>
<a name="SVN-Notify-Mirror"></a><h2>SVN-Notify-Mirror</h2>
<p><a href="http://search.cpan.org/~jpeacock/SVN-Notify-Mirror/">http://search.cpan.org/~jpeacock/SVN-Notify-Mirror/</a></p>
<p>John Peacock, author of the <code class="inline"><span class="w">SVN</span>-<span class="w">Notify</span>-<span class="w">Mirror</span></code>
 distribution, says:</p>
<dl>
<dt>1. </dt><dd><a name="1.-Using-auto_features%2c-I-check-to-see-whether-two-optional-modules-are-available---SVN%3a%3aNotify%3a%3aConfig-and-Net%3a%3aSSH%3b"></a><b>Using <code class="inline"><span class="w">auto_features</span></code>
, I check to see whether two optional
modules are available - SVN::Notify::Config and Net::SSH;</b>
</dd>
<dt>2. </dt><dd><a name="2.-If-the-S%3a%3aN%3a%3aConfig-module-is-loaded%2c-I-automatically-generate-test-files-for-it-during-Build-(using-the-PL_files-property)."></a><b>If the S::N::Config module is loaded, I automatically
generate test files for it during Build (using the <code class="inline"><span class="w">PL_files</span></code>

property).</b>
</dd>
<dt>3. </dt><dd><a name="3.-If-the-ssh_feature-is-available%2c-I-ask-if-the-user-wishes-to-perform-the-ssh-tests-(since-it-requires-a-little-preliminary-setup)%3b"></a><b>If the <code class="inline"><span class="w">ssh_feature</span></code>
 is available, I ask if the user wishes
to perform the ssh tests (since it requires a little preliminary
setup);</b>
</dd>
<dt>4. </dt><dd><a name="4.-Only-if-the-user-has-ssh_feature-and-answers-yes-to-the-testing%2c-do-I-generate-a-test-file."></a><b>Only if the user has <code class="inline"><span class="w">ssh_feature</span></code>
 and answers yes to the
testing, do I generate a test file.</b>
<p>I'm sure I could not have handled this complexity with EU::MM, but it
was very easy to do with M::B.</p>
</dd>
</dl>
<a name="Modifying-an-action"></a><h2>Modifying an action</h2>
<p>Sometimes you might need an to have an action, say <code class="inline">./Build install</code>,
do something unusual.  For instance, you might need to change the
ownership of a file or do something else peculiar to your application.</p>
<p>You can subclass <code class="inline"><span class="w">Module::Build</span></code>
 on the fly using the <code class="inline"><span class="i">subclass</span><span class="s">(</span><span class="s">)</span></code>

method and override the methods that perform the actions.  You may
need to read through <code class="inline"><span class="w">Module::Build::Authoring</span></code>
 and
<code class="inline"><span class="w">Module::Build::API</span></code>
 to find the methods you want to override.  All
"action" methods are implemented by a method called "ACTION_" followed
by the action's name, so here's an example of how it would work for
the <code class="inline"><span class="w">install</span></code>
 action:</p>
<pre class="verbatim"><ol><li>  # Build.PL</li><li>  use Module::Build;</li><li>  my $class = Module::Build-&gt;subclass(</li><li>      class =&gt; "Module::Build::Custom",</li><li>      code =&gt; &lt;&lt;'SUBCLASS' );</li><li></li><li>  sub ACTION_install {</li><li>      my $self = shift;</li><li>      # YOUR CODE HERE</li><li>      $self-&gt;SUPER::ACTION_install;</li><li>  }</li><li>  SUBCLASS</li><li></li><li>  $class-&gt;new(</li><li>      module_name =&gt; 'Your::Module',</li><li>      # rest of the usual Module::Build parameters</li><li>  )-&gt;create_build_script;</li></ol></pre><a name="Adding-an-action"></a><h2>Adding an action</h2>
<p>You can add a new <code class="inline">./Build</code> action simply by writing the method for
it in your subclass.  Use <code class="inline"><span class="w">depends_on</span></code>
 to declare that another action
must have been run before your action.</p>
<p>For example, let's say you wanted to be able to write <code class="inline">./Build
commit</code> to test your code and commit it to Subversion.</p>
<pre class="verbatim"><ol><li>  # Build.PL</li><li>  use Module::Build;</li><li>  my $class = Module::Build-&gt;subclass(</li><li>      class =&gt; "Module::Build::Custom",</li><li>      code =&gt; &lt;&lt;'SUBCLASS' );</li><li></li><li>  sub ACTION_commit {</li><li>      my $self = shift;</li><li></li><li>      $self-&gt;depends_on("test");</li><li>      $self-&gt;do_system(qw(svn commit));</li><li>  }</li><li>  SUBCLASS</li></ol></pre><a name="Bundling-Module%3a%3aBuild"></a><h2>Bundling Module::Build</h2>
<p>Note: This section probably needs an update as the technology improves
(see contrib/bundle.pl in the distribution).</p>
<p>Suppose you want to use some new-ish features of Module::Build,
e.g. newer than the version of Module::Build your users are likely to
already have installed on their systems.  The first thing you should
do is set <code class="inline"><span class="w">configure_requires</span></code>
 to your minimum version of
Module::Build.  See <a href="../../Module/Build/Authoring.html">Module::Build::Authoring</a>.</p>
<p>But not every build system honors <code class="inline"><span class="w">configure_requires</span></code>
 yet.  Here's
how you can ship a copy of Module::Build, but still use a newer
installed version to take advantage of any bug fixes and upgrades.</p>
<p>First, install Module::Build into <i>Your-Project/inc/Module-Build</i>.
CPAN will not index anything in the <i>inc</i> directory so this copy will
not show up in CPAN searches.</p>
<pre class="verbatim"><ol><li>    cd Module-Build</li><li>    perl Build.PL --install_base /path/to/Your-Project/inc/Module-Build</li><li>    ./Build test</li><li>    ./Build install</li></ol></pre><p>You should now have all the Module::Build .pm files in
<i>Your-Project/inc/Module-Build/lib/perl5</i>.</p>
<p>Next, add this to the top of your <i>Build.PL</i>.</p>
<pre class="verbatim"><ol><li>    my $Bundled_MB = 0.30;  # or whatever version it was.</li><li></li><li>    # Find out what version of Module::Build is installed or fail quietly.</li><li>    # This should be cross-platform.</li><li>    my $Installed_MB =</li><li>        `$^X -e "eval q{require Module::Build; print Module::Build-&gt;VERSION} or exit 1";</li><li></li><li>    # some operating systems put a newline at the end of every print.</li><li>    chomp $Installed_MB;</li><li></li><li>    $Installed_MB = 0 if $?;</li><li></li><li>    # Use our bundled copy of Module::Build if it's newer than the installed.</li><li>    unshift @INC, "inc/Module-Build/lib/perl5" if $Bundled_MB &gt; $Installed_MB;</li><li></li><li>    require Module::Build;</li></ol></pre><p>And write the rest of your <i>Build.PL</i> normally.  Module::Build will
remember your change to <code class="inline"><span class="i">@INC</span></code>
 and use it when you run <i>./Build</i>.</p>
<p>In the future, we hope to provide a more automated solution for this
scenario; see <code class="inline"><span class="w">inc</span>/<span class="w">latest</span>.<span class="w">pm</span></code>
 in the Module::Build distribution for
one indication of the direction we're moving.</p>
<a name="AUTHOR"></a><h1>AUTHOR</h1>
<p>Ken Williams &lt;kwilliams@cpan.org&gt;</p>
<a name="COPYRIGHT"></a><h1>COPYRIGHT</h1>
<p>Copyright (c) 2001-2008 Ken Williams.  All rights reserved.</p>
<p>This library is free software; you can redistribute it and/or
modify it under the same terms as Perl itself.</p>
<a name="SEE-ALSO"></a><h1>SEE ALSO</h1>
<p>perl(1), <a href="../../Module/Build.html">Module::Build</a>(3), <a href="../../Module/Build/Authoring.html">Module::Build::Authoring</a>(3),
<a href="../../Module/Build/API.html">Module::Build::API</a>(3)</p>




  <div id="page_index" class="hud_container">
    <div id="page_index_header" class="hud_header">
      <div id="page_index_close" class="hud_close"><a href="#" onClick="pageIndex.hide();return false;"></a></div>
      <div id="page_index_title" class="hud_title"><span class="hud_span_top">Page index</span></div>
      <div id="page_index_topright" class="hud_topright"></div>
    </div>
    <div id="page_index_content" class="hud_content">
      <ul><li><a href="#NAME">NAME</a><li><a href="#DESCRIPTION">DESCRIPTION</a><li><a href="#BASIC-RECIPES">BASIC RECIPES</a><ul><li><a href="#Installing-modules-that-use-Module%3a%3aBuild">Installing modules that use Module::Build</a><li><a href="#Modifying-Config.pm-values">Modifying Config.pm values</a><li><a href="#Installing-modules-using-the-programmatic-interface">Installing modules using the programmatic interface</a><li><a href="#Installing-to-a-temporary-directory">Installing to a temporary directory</a><li><a href="#Installing-to-a-non-standard-directory">Installing to a non-standard directory</a><li><a href="#Installing-in-the-same-location-as-ExtUtils%3a%3aMakeMaker">Installing in the same location as ExtUtils::MakeMaker</a><li><a href="#Running-a-single-test-file">Running a single test file</a></ul><li><a href="#ADVANCED-RECIPES">ADVANCED RECIPES</a><ul><li><a href="#Making-a-CPAN.pm-compatible-distribution">Making a CPAN.pm-compatible distribution</a><li><a href="#Changing-the-order-of-the-build-process">Changing the order of the build process</a><li><a href="#Adding-new-file-types-to-the-build-process">Adding new file types to the build process</a><li><a href="#Adding-new-elements-to-the-install-process">Adding new elements to the install process</a></ul><li><a href="#EXAMPLES-ON-CPAN">EXAMPLES ON CPAN</a><ul><li><a href="#SVN-Notify-Mirror">SVN-Notify-Mirror</a><li><a href="#Modifying-an-action">Modifying an action</a><li><a href="#Adding-an-action">Adding an action</a><li><a href="#Bundling-Module%3a%3aBuild">Bundling Module::Build</a></ul><li><a href="#AUTHOR">AUTHOR</a><li><a href="#COPYRIGHT">COPYRIGHT</a><li><a href="#SEE-ALSO">SEE ALSO</a></ul>
    </div>
    <div id="page_index_footer" class="hud_footer">
      <div id="page_index_bottomleft" class="hud_bottomleft"></div>
      <div id="page_index_bottom" class="hud_bottom"><span class="hud_span_bottom"></span></div>
      <div id="page_index_resize" class="hud_resize"></div>
    </div>
  </div>


	    &nbsp;
          </div>
          <div id="content_footer">
          </div>
        </div>
        <div class="clear"></div>
      </div>
      
    <div id="footer">
      <div id="footer_content">
        <div id="footer_strapline">
          perldoc.perl.org - Official documentation for the Perl programming language
        </div>
        <div id="footer_links">
          <div id="address">
            <p class="name">Contact details</p>
            <p class="address">
	      Site maintained by <a href="http://perl.jonallen.info">Jon Allen (JJ)</a><br>
	      See the <a href="http://perl.jonallen.info/projects/perldoc">project page</a> for more details
	    </p>
            <p class="contact">
              Documentation maintained by the <a href="http://lists.cpan.org/showlist.cgi?name=perl5-porters">Perl 5 Porters</a>
            </p>
          </div>
          <ul class="f1">
            <li>Manual
              <ul class="f2">
                <li><a href="../../index-overview.html">Overview</a>
                <li><a href="../../index-tutorials.html">Tutorials</a>
                <li><a href="../../index-faq.html">FAQs</a>
                <li><a href="../../index-history.html">Changes</a>
              </ul>
            <li>Reference
              <ul class="f2">
                <li><a href="../../index-language.html">Language</a>
                <li><a href="../../index-functions.html">Functions</a>
                <li><a href="../../perlop.html">Operators</a>
                <li><a href="../../perlvar.html">Variables</a>
              </ul>
            <li>Modules
              <ul class="f2">
                <li><a href="../../index-modules-A.html">Modules</a>
                <li><a href="../../index-pragmas.html">Pragmas</a>
                <li><a href="../../index-utilities.html">Utilities</a>
              </ul>
            <li>Misc
              <ul class="f2">
                <li><a href="../../index-licence.html">License</a>
                <li><a href="../../index-internals.html">Internals</a>
                <li><a href="../../index-platforms.html">Platforms</a>
              </ul>          </ul>
          <div class="clear"></div>
        </div>
      </div>
      <div id="footer_end">
      </div>
    </div>
      
    </div>
      <script language="JavaScript" type="text/javascript" src="../../static/exploreperl.js"></script>
      <script language="JavaScript" src="../../static/combined-20100403.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
  perldoc.setPath(2);
  perldoc.pageName    = 'Module::Build::Cookbook';
  perldoc.pageAddress = 'Module/Build/Cookbook.html';
  perldoc.contentPage = 1;
  explorePerl.render();
  explorePerl.addEvents('explore_anchor');
</script>
    
  </body>
</html>
